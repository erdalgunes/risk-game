(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[36],{1827:function(e,n,r){Promise.resolve().then(r.bind(r,6581))},6581:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return p}});var t=r(9566),a=r(8590),i=r(7971),o=r(7162),s=r(1170),l=r(2326),d=r(1930),c=r(8865),u=r(3544);function p(){let[e,n]=(0,a.useState)(null),[r,p]=(0,a.useState)(null),[g,x]=(0,a.useState)(!1),[h,m]=(0,a.useState)(!1),[y,f]=(0,a.useState)(null),b="\n    .game-layout {\n      display: grid;\n      grid-template-columns: 1fr;\n      gap: 16px;\n    }\n\n    @media (min-width: 768px) {\n      .game-layout {\n        grid-template-columns: 2fr 1fr;\n        gap: 24px;\n      }\n    }\n\n    @media (min-width: 1024px) {\n      .game-layout {\n        grid-template-columns: 3fr 1fr;\n        gap: 32px;\n      }\n    }\n  ",j=async e=>{if(n(e),U&&r)try{let{error:n}=await U.from("games").update({state:e}).eq("id",r);if(n)throw n}catch(e){N("Error updating game: "+e.message)}},{selectedTerritory:v,fortifyTroops:C,setFortifyTroops:E,transferTroops:w,setTransferTroops:S,message:_,handleTerritoryClick:k,handleSkip:P,handleTransfer:B}=(0,d.e)(e,j),T=async()=>{if(e&&y){if(e.currentPlayer!==y){N("It's ".concat(e.currentPlayer,"'s turn. You are playing as ").concat(y,"."));return}await P()}},[A,N]=(0,a.useState)("");(0,a.useEffect)(()=>{let e=u.env.NEXT_PUBLIC_SUPABASE_URL,n=u.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;e&&n&&m(!0)},[]);let U=(0,a.useMemo)(()=>{var e,n;return h?(e=u.env.NEXT_PUBLIC_SUPABASE_URL,n=u.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,(0,o.eI)(e,n)):null},[h]);(0,a.useEffect)(()=>{if(!U||!r)return;let e=U.channel("game:".concat(r)).on("postgres_changes",{event:"UPDATE",schema:"public",table:"games",filter:"id=eq.".concat(r)},e=>{n(e.new.state)}).subscribe();return()=>{e.unsubscribe()}},[U,r]);let I=async()=>{if(!U){N("Supabase not configured. Please set environment variables.");return}x(!0);try{let e=(0,i.PA)(),{data:r,error:t}=await U.from("games").insert({state:e,mode:"multi"}).select().single();if(t)throw t;p(r.id),n(e),f("red"),N("Game created! Share this ID: ".concat(r.id,". You are playing as RED."))}catch(e){N("Error creating game: "+e.message)}finally{x(!1)}},R=async e=>{if(!U){N("Supabase not configured. Please set environment variables.");return}x(!0);try{let{data:r,error:t}=await U.from("games").select("*").eq("id",e).single();if(t)throw t;p(r.id),n(r.state),f("blue"),N("Joined game successfully! You are playing as BLUE.")}catch(e){N("Error joining game: "+e.message)}finally{x(!1)}};return h?e?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("style",{children:b}),(0,t.jsx)("div",{style:{minHeight:"100vh",backgroundColor:"#0a0a0a",padding:"20px"},children:(0,t.jsxs)("div",{style:{maxWidth:"1400px",margin:"0 auto"},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{style:{color:"white",margin:0},children:"Risk PoC - Multiplayer"}),(0,t.jsxs)("p",{style:{color:"#888",fontSize:"14px",margin:"5px 0 0 0"},children:["Game ID: ",r]})]}),(0,t.jsx)(c.default,{href:"/",style:{padding:"10px 20px",backgroundColor:"#555",color:"white",textDecoration:"none",borderRadius:"8px"},children:"Back to Menu"})]}),(_||A)&&(0,t.jsx)("div",{style:{padding:"15px",backgroundColor:"#2a2a2a",color:"white",borderRadius:"8px",marginBottom:"20px"},children:_||A}),(0,t.jsxs)("div",{className:"game-layout",children:[(0,t.jsx)(s.t,{state:e,onTerritoryClick:(n,r)=>{if(e&&y){if(e.currentPlayer!==y){N("It's ".concat(e.currentPlayer,"'s turn. You are playing as ").concat(y,"."));return}k(n,void 0,r)}},selectedTerritory:v}),(0,t.jsx)(l.z,{state:e,selectedTerritory:v,onSkip:T,fortifyTroops:C,onFortifyTroopsChange:E,transferTroops:w,onTransferTroopsChange:S,onTransfer:B})]})]})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("style",{children:b}),(0,t.jsx)("div",{style:{minHeight:"100vh",backgroundColor:"#0a0a0a",padding:"20px"},children:(0,t.jsxs)("div",{style:{maxWidth:"600px",margin:"0 auto"},children:[(0,t.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"40px"},children:[(0,t.jsx)("h1",{style:{color:"white",margin:0},children:"Multiplayer Game"}),(0,t.jsx)(c.default,{href:"/",style:{padding:"10px 20px",backgroundColor:"#555",color:"white",textDecoration:"none",borderRadius:"8px"},children:"Back to Menu"})]}),(_||A)&&(0,t.jsx)("div",{style:{padding:"15px",backgroundColor:"#2a2a2a",color:"white",borderRadius:"8px",marginBottom:"20px"},children:_||A}),(0,t.jsxs)("div",{style:{backgroundColor:"#1a1a1a",padding:"40px",borderRadius:"8px",textAlign:"center"},children:[(0,t.jsx)("button",{onClick:I,disabled:g,style:{width:"100%",padding:"15px",fontSize:"18px",backgroundColor:"#0070f3",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",marginBottom:"20px"},children:g?"Creating...":"Create New Game"}),(0,t.jsx)("div",{style:{color:"#888",margin:"20px 0"},children:"OR"}),(0,t.jsx)("input",{type:"text",placeholder:"Enter Game ID to join",onKeyDown:e=>{"Enter"===e.key&&e.currentTarget.value&&R(e.currentTarget.value)},style:{width:"100%",padding:"15px",fontSize:"16px",borderRadius:"8px",border:"1px solid #555",backgroundColor:"#2a2a2a",color:"white",marginBottom:"10px"}}),(0,t.jsx)("p",{style:{color:"#888",fontSize:"14px"},children:"Press Enter to join"})]})]})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("style",{children:b}),(0,t.jsx)("div",{style:{minHeight:"100vh",backgroundColor:"#0a0a0a",padding:"20px",color:"white"},children:(0,t.jsxs)("div",{style:{maxWidth:"800px",margin:"0 auto",textAlign:"center",paddingTop:"100px"},children:[(0,t.jsx)("h1",{children:"Supabase Not Configured"}),(0,t.jsx)("p",{style:{color:"#888",marginTop:"20px"},children:"Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY in your .env.local file."}),(0,t.jsx)(c.default,{href:"/",style:{display:"inline-block",marginTop:"40px",padding:"10px 20px",backgroundColor:"#555",color:"white",textDecoration:"none",borderRadius:"8px"},children:"Back to Menu"})]})})]})}}},function(e){e.O(0,[865,162,760,977,844,744],function(){return e(e.s=1827)}),_N_E=e.O()}]);