(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[36],{6775:function(e,t,r){Promise.resolve().then(r.bind(r,5702))},5702:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return h}});var o=r(509),n=r(3263),i=r(5789),a=r(916),l=r(3889);function s(e){let{value:t,color:r}=e,n=e=>({position:"absolute",width:"6px",height:"6px",backgroundColor:"#fff",borderRadius:"50%",...{"top-left":{top:"5px",left:"5px"},"top-right":{top:"5px",right:"5px"},"middle-left":{top:"50%",left:"5px",transform:"translateY(-50%)"},"middle-right":{top:"50%",right:"5px",transform:"translateY(-50%)"},center:{top:"50%",left:"50%",transform:"translate(-50%, -50%)"},"bottom-left":{bottom:"5px",left:"5px"},"bottom-right":{bottom:"5px",right:"5px"}}[e]});return(0,o.jsx)("div",{style:{position:"relative",width:"32px",height:"32px",backgroundColor:r,borderRadius:"6px",boxShadow:"0 2px 4px rgba(0,0,0,0.3)",border:"1px solid rgba(255,255,255,0.2)"},children:(({1:["center"],2:["top-left","bottom-right"],3:["top-left","center","bottom-right"],4:["top-left","top-right","bottom-left","bottom-right"],5:["top-left","top-right","center","bottom-left","bottom-right"],6:["top-left","top-right","middle-left","middle-right","bottom-left","bottom-right"]})[t]||[]).map((e,t)=>(0,o.jsx)("div",{style:n(e)},t))})}function d(e){let{attackResult:t,attackerColor:r,defenderColor:i}=e,[a,l]=(0,n.useState)(!0);(0,n.useEffect)(()=>{l(!0);let e=setTimeout(()=>l(!1),600);return()=>clearTimeout(e)},[t]);let d=t.defenderLost>t.attackerLost,p=d?"#27ae60":"#e74c3c";return(0,o.jsxs)("div",{style:{marginBottom:"20px",padding:"15px",backgroundColor:"#2a2a2a",borderRadius:"8px",border:"2px solid ".concat(p),animation:a?"pulse 0.6s ease-in-out":"none"},children:[(0,o.jsx)("style",{children:"\n        @keyframes pulse {\n          0%, 100% { transform: scale(1); }\n          50% { transform: scale(1.02); }\n        }\n        @keyframes roll {\n          0% { transform: rotate(0deg); }\n          25% { transform: rotate(90deg); }\n          50% { transform: rotate(180deg); }\n          75% { transform: rotate(270deg); }\n          100% { transform: rotate(360deg); }\n        }\n      "}),(0,o.jsx)("div",{style:{fontSize:"16px",fontWeight:"bold",marginBottom:"15px",color:p,textAlign:"center"},children:d?"⚔️ Attack Successful!":"\uD83D\uDEE1️ Attack Failed!"}),(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-around",alignItems:"center",gap:"10px"},children:[(0,o.jsxs)("div",{style:{textAlign:"center",flex:1},children:[(0,o.jsx)("div",{style:{fontSize:"12px",color:r,marginBottom:"8px",fontWeight:"bold"},children:"ATTACKER"}),(0,o.jsx)("div",{style:{display:"flex",gap:"6px",justifyContent:"center",flexWrap:"wrap",animation:a?"roll 0.6s ease-in-out":"none"},children:t.attackerRolls.map((e,t)=>(0,o.jsx)(s,{value:e,color:r},t))}),(0,o.jsxs)("div",{style:{fontSize:"11px",color:"#888",marginTop:"6px"},children:["Lost: ",t.attackerLost]})]}),(0,o.jsx)("div",{style:{fontSize:"20px",fontWeight:"bold",color:"#666",padding:"0 5px"},children:"VS"}),(0,o.jsxs)("div",{style:{textAlign:"center",flex:1},children:[(0,o.jsx)("div",{style:{fontSize:"12px",color:i,marginBottom:"8px",fontWeight:"bold"},children:"DEFENDER"}),(0,o.jsx)("div",{style:{display:"flex",gap:"6px",justifyContent:"center",flexWrap:"wrap",animation:a?"roll 0.6s ease-in-out":"none"},children:t.defenderRolls.map((e,t)=>(0,o.jsx)(s,{value:e,color:i},t))}),(0,o.jsxs)("div",{style:{fontSize:"11px",color:"#888",marginTop:"6px"},children:["Lost: ",t.defenderLost]})]})]}),t.conquered&&(0,o.jsx)("div",{style:{marginTop:"12px",padding:"8px",backgroundColor:"rgba(39, 174, 96, 0.2)",borderRadius:"4px",textAlign:"center",fontSize:"14px",fontWeight:"bold",color:"#27ae60"},children:"\uD83C\uDFAF TERRITORY CONQUERED!"})]})}function p(e){var t,r;let{state:n,selectedTerritory:a,onSkip:l,fortifyTroops:s,onFortifyTroopsChange:p,transferTroops:c,onTransferTroopsChange:x,onTransfer:g}=e,h={red:"#e74c3c",blue:"#3498db",green:"#2ecc71",yellow:"#f1c40f",purple:"#9b59b6",orange:"#e67e22",neutral:"#777777"},m=h[n.currentPlayer];return(0,o.jsxs)("div",{style:{padding:"20px",backgroundColor:"#1a1a1a",borderRadius:"8px",color:"white",width:"100%",maxWidth:"400px"},children:[(0,o.jsx)("h2",{style:{margin:"0 0 20px 0"},children:"Game Status"}),n.winner?(0,o.jsx)("div",{style:{padding:"20px",backgroundColor:h[n.winner],borderRadius:"8px",textAlign:"center"},children:(0,o.jsxs)("h3",{style:{margin:0},children:[n.winner.toUpperCase()," WINS!"]})}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{style:{marginBottom:"20px"},children:(0,o.jsxs)("div",{style:{display:"inline-block",padding:"10px 20px",backgroundColor:m,borderRadius:"8px",fontWeight:"bold",fontSize:"18px"},children:[n.currentPlayer.toUpperCase(),"'S TURN"]})}),(0,o.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,o.jsxs)("p",{style:{margin:"5px 0",fontSize:"16px"},children:["Phase: ",(0,o.jsx)("strong",{children:n.phase.toUpperCase()})]}),a&&(0,o.jsxs)("p",{style:{margin:"5px 0",fontSize:"16px"},children:["Selected: ",(0,o.jsx)("strong",{children:a.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())})]})]}),"initial_placement"===n.phase&&(0,o.jsxs)("div",{style:{marginBottom:"20px",padding:"15px",backgroundColor:"#2a2a2a",borderRadius:"8px"},children:[(0,o.jsx)("div",{style:{fontSize:"20px",fontWeight:"bold",marginBottom:"10px",color:"#f39c12"},children:"Initial Setup Phase"}),(0,o.jsx)("div",{style:{fontSize:"16px",marginBottom:"10px"},children:"claiming"===n.initialPlacementSubPhase?"Claiming Territories":"Placing Remaining Troops"}),(0,o.jsxs)("div",{style:{fontSize:"24px",fontWeight:"bold",marginBottom:"10px"},children:[null!==(r=null===(t=n.unplacedTroops)||void 0===t?void 0:t[n.currentPlayer])&&void 0!==r?r:0," Troops Left"]}),(0,o.jsx)("p",{style:{fontSize:"14px",color:"#888",marginTop:"10px",marginBottom:"0"},children:"claiming"===n.initialPlacementSubPhase?"Click any unclaimed territory to claim it with 1 troop.":"Click your territories to place 1 troop at a time."})]}),"deploy"===n.phase&&(0,o.jsxs)("div",{style:{marginBottom:"20px",padding:"15px",backgroundColor:"#2a2a2a",borderRadius:"8px"},children:[(0,o.jsxs)("div",{style:{fontSize:"24px",fontWeight:"bold",marginBottom:"10px"},children:[n.deployableTroops," ",1===n.deployableTroops?"Troop":"Troops"," Available"]}),(0,o.jsxs)("div",{style:{fontSize:"14px",color:"#888"},children:[(0,o.jsx)("div",{style:{marginBottom:"5px"},children:"Income Breakdown:"}),(0,o.jsxs)("div",{children:["• Territories: ",Math.floor((0,i.qr)(n.currentPlayer,n.territories)/3)]}),(0,o.jsxs)("div",{children:["• Continent Bonus: +",(0,i.Oc)(n.currentPlayer,n.territories)]}),(0,o.jsx)("div",{style:{marginTop:"5px",color:"#aaa"},children:"(Minimum: 3 troops)"})]}),(0,o.jsx)("p",{style:{fontSize:"14px",color:"#888",marginTop:"10px",marginBottom:"0"},children:"Click your territories to deploy troops. Click = 1 troop, Shift+Click = all troops."})]}),"attack_transfer"===n.phase&&n.pendingTransfer&&(0,o.jsxs)("div",{style:{marginBottom:"20px",padding:"15px",backgroundColor:"#2a2a2a",borderRadius:"8px"},children:[(0,o.jsx)("div",{style:{fontSize:"20px",fontWeight:"bold",marginBottom:"10px",color:"#27ae60"},children:"Territory Conquered!"}),(0,o.jsxs)("div",{style:{fontSize:"14px",marginBottom:"15px",color:"#888"},children:["Move troops from ",n.pendingTransfer.from.replace(/_/g," ")," to ",n.pendingTransfer.to.replace(/_/g," ")]}),(0,o.jsxs)("label",{style:{display:"block",marginBottom:"10px"},children:["Troops to move: ",c]}),(0,o.jsx)("input",{type:"range",min:n.pendingTransfer.minTroops,max:n.pendingTransfer.maxTroops,value:c,onChange:e=>x(parseInt(e.target.value)),style:{width:"100%",marginBottom:"15px"}}),(0,o.jsxs)("div",{style:{fontSize:"12px",color:"#888",marginBottom:"15px"},children:["Min: ",n.pendingTransfer.minTroops," | Max: ",n.pendingTransfer.maxTroops]}),(0,o.jsx)("button",{onClick:g,style:{width:"100%",padding:"16px",fontSize:"16px",backgroundColor:"#27ae60",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",minHeight:"48px",fontWeight:"600"},children:"Confirm Transfer"})]}),"attack"===n.phase&&(0,o.jsxs)(o.Fragment,{children:[n.lastAttackResult&&(0,o.jsx)(d,{attackResult:n.lastAttackResult,attackerColor:m,defenderColor:h[n.lastAttackResult.defender||"neutral"]}),(0,o.jsx)("div",{style:{marginBottom:"20px"},children:(0,o.jsx)("p",{style:{fontSize:"14px",color:"#888"},children:"Click one of your territories with 2+ troops, then click an adjacent enemy territory to attack."})})]}),"fortify"===n.phase&&!n.fortifiedThisTurn&&!a&&(0,o.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,o.jsx)("p",{style:{fontSize:"14px",color:"#888"},children:"Click one of your territories with 2+ troops to select it, then click a connected territory to move troops."}),(0,o.jsx)("p",{style:{fontSize:"12px",color:"#f39c12",marginTop:"10px"},children:"⚠️ You can only fortify once per turn"})]}),"fortify"===n.phase&&n.fortifiedThisTurn&&(0,o.jsxs)("div",{style:{marginBottom:"20px",padding:"15px",backgroundColor:"#2a2a2a",borderRadius:"8px"},children:[(0,o.jsx)("div",{style:{fontSize:"16px",color:"#f39c12",marginBottom:"10px"},children:"✓ Already fortified this turn"}),(0,o.jsx)("p",{style:{fontSize:"14px",color:"#888"},children:'Click "End Turn" to pass to the next player.'})]}),"fortify"===n.phase&&a&&(0,o.jsxs)("div",{style:{marginBottom:"20px"},children:[(0,o.jsx)("label",{style:{display:"block",marginBottom:"10px"},children:"Troops to move:"}),(0,o.jsx)("input",{type:"number",min:"1",max:n.territories[a].troops-1,value:s,onChange:e=>p(parseInt(e.target.value)||1),style:{width:"100%",padding:"14px",fontSize:"16px",borderRadius:"8px",border:"1px solid #555",backgroundColor:"#2a2a2a",color:"white",minHeight:"48px"}}),(0,o.jsx)("p",{style:{fontSize:"14px",color:"#888",marginTop:"10px"},children:"Click a connected territory you own to move troops."})]}),"attack_transfer"!==n.phase&&(0,o.jsx)("button",{onClick:l,disabled:"deploy"===n.phase&&n.deployableTroops>0||"initial_placement"===n.phase,style:{width:"100%",padding:"16px",fontSize:"16px",backgroundColor:"deploy"===n.phase&&n.deployableTroops>0||"initial_placement"===n.phase?"#333":"#555",color:"deploy"===n.phase&&n.deployableTroops>0||"initial_placement"===n.phase?"#666":"white",border:"none",borderRadius:"8px",cursor:"deploy"===n.phase&&n.deployableTroops>0||"initial_placement"===n.phase?"not-allowed":"pointer",minHeight:"48px",fontWeight:"600",transition:"background-color 200ms ease-in-out"},onMouseEnter:e=>{"deploy"===n.phase&&n.deployableTroops>0||"initial_placement"===n.phase||(e.currentTarget.style.backgroundColor="#666")},onMouseLeave:e=>{"deploy"===n.phase&&n.deployableTroops>0||"initial_placement"===n.phase||(e.currentTarget.style.backgroundColor="#555")},children:"initial_placement"===n.phase?"Place All Troops First":"deploy"===n.phase?n.deployableTroops>0?"Deploy ".concat(n.deployableTroops," Remaining Troops"):"Start Attack Phase":"attack"===n.phase?"Skip to Fortify":"End Turn"})]}),(0,o.jsxs)("div",{style:{marginTop:"30px",paddingTop:"20px",borderTop:"1px solid #333"},children:[(0,o.jsx)("h3",{style:{margin:"0 0 15px 0",fontSize:"16px"},children:"Player Stats"}),(0,o.jsx)("div",{style:{display:"grid",gridTemplateColumns:n.players.length<=3?"repeat(".concat(n.players.length,", 1fr)"):"repeat(2, 1fr)",gap:"15px"},children:n.players.map(e=>{let t=(0,i.qr)(e,n.territories),r=(0,i.Oc)(e,n.territories),a=i.bO.filter(t=>t.territories.every(t=>n.territories[t].owner===e)).map(e=>e.displayName);return(0,o.jsxs)("div",{style:{padding:"10px",backgroundColor:"#2a2a2a",borderRadius:"4px",border:e===n.currentPlayer?"2px solid ".concat(h[e]):"2px solid transparent"},children:[(0,o.jsx)("div",{style:{color:h[e],fontWeight:"bold",fontSize:"14px"},children:e.toUpperCase()}),(0,o.jsxs)("div",{style:{fontSize:"20px",marginTop:"5px"},children:[t,"/42"]}),r>0&&(0,o.jsxs)("div",{style:{fontSize:"12px",color:"#888",marginTop:"5px"},children:["+",r," bonus",a.length>0&&(0,o.jsxs)("div",{style:{fontSize:"10px",marginTop:"2px"},children:["(",a.join(", "),")"]})]})]},e)})})]})]})}var c=r(9947),x=r(3520),g=r(4614);function h(){let[e,t]=(0,n.useState)(null),[r,s]=(0,n.useState)(null),[d,h]=(0,n.useState)(!1),[m,u]=(0,n.useState)(!1),[f,y]=(0,n.useState)(null),b="\n    .game-layout {\n      display: grid;\n      grid-template-columns: 1fr;\n      gap: 16px;\n    }\n\n    @media (min-width: 768px) {\n      .game-layout {\n        grid-template-columns: 2fr 1fr;\n        gap: 24px;\n      }\n    }\n\n    @media (min-width: 1024px) {\n      .game-layout {\n        grid-template-columns: 3fr 1fr;\n        gap: 32px;\n      }\n    }\n  ",j=async e=>{if(t(e),A&&r)try{let{error:t}=await A.from("games").update({state:e}).eq("id",r);if(t)throw t}catch(e){z("Error updating game: "+e.message)}},{selectedTerritory:v,fortifyTroops:T,setFortifyTroops:k,transferTroops:C,setTransferTroops:S,message:w,handleTerritoryClick:B,handleSkip:E,handleTransfer:R}=(0,c.e)(e,j),_=async()=>{if(e&&f){if(e.currentPlayer!==f){z("It's ".concat(e.currentPlayer,"'s turn. You are playing as ").concat(f,"."));return}await E()}},[P,z]=(0,n.useState)("");(0,n.useEffect)(()=>{let e=g.env.NEXT_PUBLIC_SUPABASE_URL,t=g.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;e&&t&&u(!0)},[]);let A=(0,n.useMemo)(()=>{var e,t;return m?(e=g.env.NEXT_PUBLIC_SUPABASE_URL,t=g.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,(0,a.eI)(e,t)):null},[m]);(0,n.useEffect)(()=>{if(!A||!r)return;let e=A.channel("game:".concat(r)).on("postgres_changes",{event:"UPDATE",schema:"public",table:"games",filter:"id=eq.".concat(r)},e=>{t(e.new.state)}).subscribe();return()=>{e.unsubscribe()}},[A,r]);let N=async()=>{if(!A){z("Supabase not configured. Please set environment variables.");return}h(!0);try{let e=(0,i.PA)(),{data:r,error:o}=await A.from("games").insert({state:e,mode:"multi"}).select().single();if(o)throw o;if(!r)throw Error("No data returned");s(r.id),t(r.state),y("red"),z("Game created! Share this ID: ".concat(r.id,". You are playing as RED."))}catch(e){z("Error creating game: "+e.message)}finally{h(!1)}},U=async e=>{if(!A){z("Supabase not configured. Please set environment variables.");return}h(!0);try{let{data:r,error:o}=await A.from("games").select("*").eq("id",e).single();if(o)throw o;if(!r)throw Error("No data returned");s(r.id),t(r.state),y("blue"),z("Joined game successfully! You are playing as BLUE.")}catch(e){z("Error joining game: "+e.message)}finally{h(!1)}};return m?e?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("style",{children:b}),(0,o.jsx)("div",{style:{minHeight:"100vh",backgroundColor:"#0a0a0a",padding:"20px"},children:(0,o.jsxs)("div",{style:{maxWidth:"1400px",margin:"0 auto"},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{style:{color:"white",margin:0},children:"Risk PoC - Multiplayer"}),(0,o.jsxs)("p",{style:{color:"#888",fontSize:"14px",margin:"5px 0 0 0"},children:["Game ID: ",r]})]}),(0,o.jsx)(x.default,{href:"/",style:{padding:"10px 20px",backgroundColor:"#555",color:"white",textDecoration:"none",borderRadius:"8px"},children:"Back to Menu"})]}),(w||P)&&(0,o.jsx)("div",{style:{padding:"15px",backgroundColor:"#2a2a2a",color:"white",borderRadius:"8px",marginBottom:"20px"},children:w||P}),(0,o.jsxs)("div",{className:"game-layout",children:[(0,o.jsx)(l.t,{state:e,onTerritoryClick:(t,r)=>{if(e&&f){if(e.currentPlayer!==f){z("It's ".concat(e.currentPlayer,"'s turn. You are playing as ").concat(f,"."));return}B(t,void 0,r)}},selectedTerritory:v}),(0,o.jsx)(p,{state:e,selectedTerritory:v,onSkip:_,fortifyTroops:T,onFortifyTroopsChange:k,transferTroops:C,onTransferTroopsChange:S,onTransfer:R})]})]})})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("style",{children:b}),(0,o.jsx)("div",{style:{minHeight:"100vh",backgroundColor:"#0a0a0a",padding:"20px"},children:(0,o.jsxs)("div",{style:{maxWidth:"600px",margin:"0 auto"},children:[(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"40px"},children:[(0,o.jsx)("h1",{style:{color:"white",margin:0},children:"Multiplayer Game"}),(0,o.jsx)(x.default,{href:"/",style:{padding:"10px 20px",backgroundColor:"#555",color:"white",textDecoration:"none",borderRadius:"8px"},children:"Back to Menu"})]}),(w||P)&&(0,o.jsx)("div",{style:{padding:"15px",backgroundColor:"#2a2a2a",color:"white",borderRadius:"8px",marginBottom:"20px"},children:w||P}),(0,o.jsxs)("div",{style:{backgroundColor:"#1a1a1a",padding:"40px",borderRadius:"8px",textAlign:"center"},children:[(0,o.jsx)("button",{onClick:N,disabled:d,style:{width:"100%",padding:"15px",fontSize:"18px",backgroundColor:"#0070f3",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",marginBottom:"20px"},children:d?"Creating...":"Create New Game"}),(0,o.jsx)("div",{style:{color:"#888",margin:"20px 0"},children:"OR"}),(0,o.jsx)("input",{type:"text",placeholder:"Enter Game ID to join",onKeyDown:e=>{"Enter"===e.key&&e.currentTarget.value&&U(e.currentTarget.value)},style:{width:"100%",padding:"15px",fontSize:"16px",borderRadius:"8px",border:"1px solid #555",backgroundColor:"#2a2a2a",color:"white",marginBottom:"10px"}}),(0,o.jsx)("p",{style:{color:"#888",fontSize:"14px"},children:"Press Enter to join"})]})]})})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("style",{children:b}),(0,o.jsx)("div",{style:{minHeight:"100vh",backgroundColor:"#0a0a0a",padding:"20px",color:"white"},children:(0,o.jsxs)("div",{style:{maxWidth:"800px",margin:"0 auto",textAlign:"center",paddingTop:"100px"},children:[(0,o.jsx)("h1",{children:"Supabase Not Configured"}),(0,o.jsx)("p",{style:{color:"#888",marginTop:"20px"},children:"Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY in your .env.local file."}),(0,o.jsx)(x.default,{href:"/",style:{display:"inline-block",marginTop:"40px",padding:"10px 20px",backgroundColor:"#555",color:"white",textDecoration:"none",borderRadius:"8px"},children:"Back to Menu"})]})})]})}}},function(e){e.O(0,[520,916,210,452,693,744],function(){return e(e.s=6775)}),_N_E=e.O()}]);