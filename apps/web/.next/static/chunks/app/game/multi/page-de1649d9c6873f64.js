(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[36],{7323:function(e,t,r){Promise.resolve().then(r.bind(r,4762))},4762:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return x}});var n=r(6911),a=r(3761),i=r(4858),o=r(6543),s=r(3623),l=r(7613),d=r(7844),c=r(350),u=r.n(c),p=r(6580);function x(){let[e,t]=(0,a.useState)(null),[r,c]=(0,a.useState)(null),[x,g]=(0,a.useState)(!1),[h,y]=(0,a.useState)(!1),[m,f]=(0,a.useState)(null),b=async e=>{if(t(e),B&&r)try{let{error:t}=await B.from("games").update({state:e}).eq("id",r);if(t)throw t}catch(e){P("Error updating game: "+e.message)}},{selectedTerritory:j,fortifyTroops:v,setFortifyTroops:C,message:E,handleTerritoryClick:S,handleSkip:_}=(0,d.e)(e,b),k=async()=>{if(e&&m){if(e.currentPlayer!==m){P("It's ".concat(e.currentPlayer,"'s turn. You are playing as ").concat(m,"."));return}await _()}},[w,P]=(0,a.useState)("");(0,a.useEffect)(()=>{let e=p.env.NEXT_PUBLIC_SUPABASE_URL,t=p.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;e&&t&&y(!0)},[]);let B=(0,a.useMemo)(()=>{var e,t;return h?(e=p.env.NEXT_PUBLIC_SUPABASE_URL,t=p.env.NEXT_PUBLIC_SUPABASE_ANON_KEY,(0,o.eI)(e,t)):null},[h]);(0,a.useEffect)(()=>{if(!B||!r)return;let e=B.channel("game:".concat(r)).on("postgres_changes",{event:"UPDATE",schema:"public",table:"games",filter:"id=eq.".concat(r)},e=>{t(e.new.state)}).subscribe();return()=>{e.unsubscribe()}},[B,r]);let A=async()=>{if(!B){P("Supabase not configured. Please set environment variables.");return}g(!0);try{let e=(0,i.PA)(),{data:r,error:n}=await B.from("games").insert({state:e,mode:"multi"}).select().single();if(n)throw n;c(r.id),t(e),f("red"),P("Game created! Share this ID: ".concat(r.id,". You are playing as RED."))}catch(e){P("Error creating game: "+e.message)}finally{g(!1)}},T=async e=>{if(!B){P("Supabase not configured. Please set environment variables.");return}g(!0);try{let{data:r,error:n}=await B.from("games").select("*").eq("id",e).single();if(n)throw n;c(r.id),t(r.state),f("blue"),P("Joined game successfully! You are playing as BLUE.")}catch(e){P("Error joining game: "+e.message)}finally{g(!1)}};return h?e?(0,n.jsx)("div",{style:{minHeight:"100vh",backgroundColor:"#0a0a0a",padding:"20px"},children:(0,n.jsxs)("div",{style:{maxWidth:"1200px",margin:"0 auto"},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{style:{color:"white",margin:0},children:"Risk PoC - Multiplayer"}),(0,n.jsxs)("p",{style:{color:"#888",fontSize:"14px",margin:"5px 0 0 0"},children:["Game ID: ",r]})]}),(0,n.jsx)(u(),{href:"/",style:{padding:"10px 20px",backgroundColor:"#555",color:"white",textDecoration:"none",borderRadius:"8px"},children:"Back to Menu"})]}),(E||w)&&(0,n.jsx)("div",{style:{padding:"15px",backgroundColor:"#2a2a2a",color:"white",borderRadius:"8px",marginBottom:"20px"},children:E||w}),(0,n.jsxs)("div",{style:{display:"flex",gap:"20px",alignItems:"flex-start"},children:[(0,n.jsx)(s.t,{state:e,onTerritoryClick:t=>{if(e&&m){if(e.currentPlayer!==m){P("It's ".concat(e.currentPlayer,"'s turn. You are playing as ").concat(m,"."));return}S(t)}},selectedTerritory:j}),(0,n.jsx)(l.z,{state:e,selectedTerritory:j,onSkip:k,fortifyTroops:v,onFortifyTroopsChange:C})]})]})}):(0,n.jsx)("div",{style:{minHeight:"100vh",backgroundColor:"#0a0a0a",padding:"20px"},children:(0,n.jsxs)("div",{style:{maxWidth:"600px",margin:"0 auto"},children:[(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"40px"},children:[(0,n.jsx)("h1",{style:{color:"white",margin:0},children:"Multiplayer Game"}),(0,n.jsx)(u(),{href:"/",style:{padding:"10px 20px",backgroundColor:"#555",color:"white",textDecoration:"none",borderRadius:"8px"},children:"Back to Menu"})]}),(E||w)&&(0,n.jsx)("div",{style:{padding:"15px",backgroundColor:"#2a2a2a",color:"white",borderRadius:"8px",marginBottom:"20px"},children:E||w}),(0,n.jsxs)("div",{style:{backgroundColor:"#1a1a1a",padding:"40px",borderRadius:"8px",textAlign:"center"},children:[(0,n.jsx)("button",{onClick:A,disabled:x,style:{width:"100%",padding:"15px",fontSize:"18px",backgroundColor:"#0070f3",color:"white",border:"none",borderRadius:"8px",cursor:"pointer",marginBottom:"20px"},children:x?"Creating...":"Create New Game"}),(0,n.jsx)("div",{style:{color:"#888",margin:"20px 0"},children:"OR"}),(0,n.jsx)("input",{type:"text",placeholder:"Enter Game ID to join",onKeyDown:e=>{"Enter"===e.key&&e.currentTarget.value&&T(e.currentTarget.value)},style:{width:"100%",padding:"15px",fontSize:"16px",borderRadius:"8px",border:"1px solid #555",backgroundColor:"#2a2a2a",color:"white",marginBottom:"10px"}}),(0,n.jsx)("p",{style:{color:"#888",fontSize:"14px"},children:"Press Enter to join"})]})]})}):(0,n.jsx)("div",{style:{minHeight:"100vh",backgroundColor:"#0a0a0a",padding:"20px",color:"white"},children:(0,n.jsxs)("div",{style:{maxWidth:"800px",margin:"0 auto",textAlign:"center",paddingTop:"100px"},children:[(0,n.jsx)("h1",{children:"Supabase Not Configured"}),(0,n.jsx)("p",{style:{color:"#888",marginTop:"20px"},children:"Please set NEXT_PUBLIC_SUPABASE_URL and NEXT_PUBLIC_SUPABASE_ANON_KEY in your .env.local file."}),(0,n.jsx)(u(),{href:"/",style:{display:"inline-block",marginTop:"40px",padding:"10px 20px",backgroundColor:"#555",color:"white",textDecoration:"none",borderRadius:"8px"},children:"Back to Menu"})]})})}}},function(e){e.O(0,[161,543,464,200,533,744],function(){return e(e.s=7323)}),_N_E=e.O()}]);